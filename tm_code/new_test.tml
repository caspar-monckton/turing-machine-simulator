machine test_machine:
    accept: q3, q7
    start: q1
    recognise: 0, 1

    state q1:
        1 -> q1, 1, LEFT
        0 -> q1, 1, RIGHT
    end

    state q2: 
        1 -> q1, 0, RIGHT
        0 -> @outer_machine, 0, RIGHT
    end
end

machine outer_machine:
    accept: q1
    start: q0
    recognise: 0, 1

    state q0: 
        1 -> q0, 1, LEFT
        0 -> @test_machine, 1, LEFT
    end

    state test_machine:
        1 -> q0, 0, RIGHT
        0 -> @test_machine, 0, RIGHT
    end
end

outer_machine(0)